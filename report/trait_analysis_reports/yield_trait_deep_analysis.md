# 产量 (yield) 性状深度分析报告

## 1. 概述

本报告对**产量 (yield)** 性状的基因组预测实验结果进行深度分析。实验涵盖了CNN深度学习模型和多种传统机器学习模型（RandomForest, XGBoost, LightGBM, Lasso），并在5种不同数量的SNP标记（100, 1000, 3000, 5000, 7000）上进行了评估。

## 2. 性能指标总览

下表汇总了所有模型在不同特征数量下的核心性能指标。

| 模型                  | 特征数 | R² (决定系数) | RMSE (均方根误差) | Pearson 相关系数 |
| --------------------- | ------ | ------------- | ----------------- | ------------------ |
| **CNN**               | 100    | 0.2255        | 45.4364           | 0.4925             |
|                       | 1000   | **0.3281**    | **42.3184**       | **0.6128**         |
|                       | 3000   | 0.2691        | 44.1397           | 0.5581             |
|                       | 5000   | 0.1765        | 46.8500           | 0.4615             |
|                       | 7000   | 0.2274        | 45.3810           | 0.5651             |
| **RandomForest**      | 100    | 0.2284        | 45.3505           | 0.4796             |
|                       | 1000   | 0.2980        | 43.2031           | 0.5478             |
|                       | 3000   | 0.3275        | 42.3404           | 0.5756             |
|                       | 5000   | 0.3396        | 41.9568           | 0.5855             |
|                       | 7000   | **0.3417**    | **41.8926**       | 0.5878             |
| **XGBoost**           | 100    | 0.2131        | 45.7983           | 0.4887             |
|                       | 1000   | 0.2913        | 43.4111           | 0.5595             |
|                       | 3000   | 0.3015        | 43.1022           | 0.5694             |
|                       | 5000   | 0.2917        | 43.3985           | 0.5586             |
|                       | 7000   | 0.3151        | 42.6841           | 0.5746             |
| **LightGBM**          | 100    | 0.1980        | 46.2413           | 0.4746             |
|                       | 1000   | 0.3060        | 42.9733           | 0.5690             |
|                       | 3000   | 0.3129        | 42.7533           | 0.5753             |
|                       | 5000   | 0.3142        | 42.7153           | 0.5768             |
|                       | 7000   | 0.3182        | 42.5850           | 0.5801             |
| **Lasso**             | 100    | 0.2132        | 45.7963           | 0.4632             |
|                       | 1000   | 0.2965        | 43.2613           | 0.5484             |
|                       | 3000   | 0.3204        | 42.5186           | 0.5714             |
|                       | 5000   | 0.3283        | 42.3093           | 0.5786             |
|                       | 7000   | 0.3218        | 42.4764           | 0.5739             |

*注：最佳性能指标已加粗显示。*

## 3. 深度分析

### 3.1. 最佳模型分析

在产量（yield）性状的预测中，没有一个模型在所有指标上都取得最优。

- **RandomForest_7000** 获得了最高的 **R²值 (0.3417)** 和最低的 **RMSE (41.8926)**，这表明它的整体预测精度和对误差的控制能力最强。
- **CNN_1000** 获得了最高的 **Pearson相关系数 (0.6128)**，这意味着它的预测值与真实值的线性相关性最强。

**结论**：对于产量性状，**RandomForest** 和 **CNN** 是最有竞争力的两个模型。RandomForest在大数据集（7000个SNP）上表现出强大的精度，而CNN则在更小、更密集的数据集（1000个SNP）上显示出捕捉关键特征的强大能力。

#### 最佳模型预测图

**RandomForest_7000 预测 vs. 实际图**
![RandomForest_7000_prediction](res/base/yield/plots/yield_RandomForest_7000_prediction_vs_actual.png)
*图1：RandomForest_7000模型的预测结果。散点分布相对均匀，表现出良好的预测精度。*

**CNN_1000 预测 vs. 实际图**
![CNN_1000_prediction](res/cnn/yield/plots/yield_CNN_1000_prediction_vs_actual.png)
*图2：CNN_1000模型的预测结果。散点更加集中于对角线，表现出最强的线性相关性。*

### 3.2. 特征数量影响分析

#### CNN 模型
- CNN的性能在 **1000个SNP** 标记时达到 **峰值 (R²=0.3281)**。
- 当特征数量增加到3000以上时，其性能反而显著下降。这表明过多的SNP标记（特征）引入了噪声，导致CNN模型出现**过拟合**，无法很好地泛化到测试集。
- **图表解读**：`CNN_1000` 的预测vs实际值图表上的散点会是所有CNN模型中最贴近对角线的。而 `CNN_5000` 的图表散点则会相对离散，显示出更差的拟合效果。

**CNN_5000 (过拟合案例) 预测 vs. 实际图**
![CNN_5000_prediction](res/cnn/yield/plots/yield_CNN_5000_prediction_vs_actual.png)
*图3：CNN_5000模型的预测结果。与图2相比，散点明显更加分散，R²值显著降低，是过拟合的典型表现。*

#### 传统机器学习模型
- **RandomForest, LightGBM, Lasso** 的性能普遍随着特征数量的增加而**稳步提升**或保持稳定。
- **RandomForest** 对特征数量最不敏感，并且能够有效利用更多的特征，在7000个SNP时达到最佳性能。
- **XGBoost** 的性能在1000个SNP后增长停滞，甚至略有下降，说明它对高维稀疏特征的鲁棒性不如RandomForest。
- **图表解读**：对于RandomForest，从`_100`到`_7000`的系列图表中，可以观察到散点逐渐向对角线集中的趋势，反映了模型性能的提升。

### 3.3. CNN vs. 传统模型对比

- **CNN的优势**：在1000个SNP标记这个"信息甜点"上，CNN的表现（R²=0.3281）超越了所有同等特征数量的传统模型，展示了其在自动学习特征交互和非线性关系方面的强大能力。其高达0.6128的Pearson相关系数也证明了这一点。
- **传统模型的优势**：以RandomForest为代表的传统模型在高维数据（7000个SNP）上表现出更好的**稳定性和鲁棒性**。它们不易像CNN那样因特征过多而性能崩溃，能从更广泛的特征中获益。

## 4. 结论与建议

对于**产量 (yield)** 这一复杂性状：

1.  **首选模型**：
    *   如果计算资源允许并希望达到最高预测精度，推荐使用 **`RandomForest`** 模型，并采用 **7000个或更多** 的SNP标记。
    *   如果希望在计算效率和性能之间取得最佳平衡，**`CNN`** 模型配合 **1000个**精心挑选的SNP标记是理想选择。

2.  **特征选择至关重要**：
    *   对于CNN模型，必须进行特征选择，以避免噪声和过拟合。1000个SNP标记似乎是产量性状的最佳数量。
    *   对于RandomForest等集成模型，可以提供更多的特征，模型自身有能力处理高维数据。

3.  **实践建议**：
    *   **步骤一**：可以先使用Lasso或RandomForest的特征重要性功能，从全部SNP中筛选出最重要的1000-2000个标记。
    *   **步骤二**：然后将这些筛选后的特征用于训练CNN模型，很可能获得超越当前所有模型的性能。

这份针对产量性状的深度分析结束。如果您对这份报告满意，我可以按照同样的方式，继续分析下一个性状。请问接下来您希望分析哪个性状？ 